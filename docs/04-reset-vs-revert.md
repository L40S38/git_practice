# 04. Reset ã¨ Revert ã®é•ã„ - å–ã‚Šæ¶ˆã—ã®2ã¤ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

Git ã§å¤‰æ›´ã‚’å–ã‚Šæ¶ˆã™éš›ã®2ã¤ã®ä¸»è¦ãªæ–¹æ³•ã€`git reset` ã¨ `git revert` ã®é•ã„ã«ã¤ã„ã¦è©³ã—ãèª¬æ˜ã—ã¾ã™ã€‚ã©ã¡ã‚‰ã‚‚ã€Œå–ã‚Šæ¶ˆã—ã€ã‚’è¡Œã„ã¾ã™ãŒã€å±¥æ­´ã¸ã®å½±éŸ¿ãŒæ ¹æœ¬çš„ã«ç•°ãªã‚Šã¾ã™ã€‚

## ğŸ“‹ ç›®æ¬¡

- [reset ã¨ revert ã®åŸºæœ¬æ¦‚å¿µ](#reset-ã¨-revert-ã®åŸºæœ¬æ¦‚å¿µ)
- [git reset - å±¥æ­´ã®å·»ãæˆ»ã—](#git-reset---å±¥æ­´ã®å·»ãæˆ»ã—)
- [git revert - å–ã‚Šæ¶ˆã—ã‚³ãƒŸãƒƒãƒˆã®ä½œæˆ](#git-revert---å–ã‚Šæ¶ˆã—ã‚³ãƒŸãƒƒãƒˆã®ä½œæˆ)
- [å‹•ä½œã®é•ã„ã‚’ Mermaid ã§æ¯”è¼ƒ](#å‹•ä½œã®é•ã„ã‚’-mermaid-ã§æ¯”è¼ƒ)
- [å®Ÿè·µä¾‹ã§ã®é•ã„ã®ç¢ºèª](#å®Ÿè·µä¾‹ã§ã®é•ã„ã®ç¢ºèª)
- [ä½¿ã„åˆ†ã‘ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³](#ä½¿ã„åˆ†ã‘ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³)

---

## reset ã¨ revert ã®åŸºæœ¬æ¦‚å¿µ

### âª git reset ã®ç‰¹å¾´
**å±¥æ­´ã®å·»ãæˆ»ã—** - æŒ‡å®šã—ãŸã‚³ãƒŸãƒƒãƒˆã¾ã§å±¥æ­´ã‚’å·»ãæˆ»ã—ã€ãã‚Œä»¥é™ã‚’å‰Šé™¤

### â†©ï¸ git revert ã®ç‰¹å¾´  
**å–ã‚Šæ¶ˆã—ã‚³ãƒŸãƒƒãƒˆã®ä½œæˆ** - æŒ‡å®šã—ãŸã‚³ãƒŸãƒƒãƒˆã®å¤‰æ›´ã‚’æ‰“ã¡æ¶ˆã™æ–°ã—ã„ã‚³ãƒŸãƒƒãƒˆã‚’ä½œæˆ

### ğŸ¯ æ ¹æœ¬çš„ãªé•ã„

| è¦³ç‚¹ | git reset | git revert |
|-----|-----------|------------|
| **å±¥æ­´ã¸ã®å½±éŸ¿** | å±¥æ­´ã‚’å‰Šé™¤ãƒ»æ”¹å¤‰ | å±¥æ­´ã«è¿½åŠ  |
| **å®‰å…¨æ€§** | å±é™ºï¼ˆå±¥æ­´ãŒå¤±ã‚ã‚Œã‚‹ï¼‰ | å®‰å…¨ï¼ˆå±¥æ­´ã¯ä¿æŒï¼‰ |
| **å…¬é–‹æ¸ˆã¿ãƒ–ãƒ©ãƒ³ãƒ** | âŒ é¿ã‘ã‚‹ã¹ã | âœ… å®‰å…¨ã«ä½¿ç”¨å¯èƒ½ |
| **å¯¾è±¡** | é€£ç¶šã—ãŸã‚³ãƒŸãƒƒãƒˆç¾¤ | ä»»æ„ã®å˜ä¸€ã‚³ãƒŸãƒƒãƒˆ |
| **å…ƒã«æˆ»ã™æ–¹æ³•** | reflog ã‹ã‚‰å¾©æ—§ | revert ã® revert |
| **é©ç”¨å ´é¢** | ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™º | ãƒãƒ¼ãƒ é–‹ç™ºãƒ»æœ¬ç•ªç’°å¢ƒ |

---

## git reset - å±¥æ­´ã®å·»ãæˆ»ã—

### ğŸ“– æ¦‚è¦
HEADã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ã‚¨ãƒªã‚¢ï¼‰ã€ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®šã—ãŸã‚³ãƒŸãƒƒãƒˆã®çŠ¶æ…‹ã«æˆ»ã—ã¾ã™ã€‚

### ğŸ’¡ reset ã®3ã¤ã®ãƒ¢ãƒ¼ãƒ‰

#### --soft : HEAD ã®ã¿ç§»å‹•
```bash
git reset --soft HEAD~1
```
- HEAD ã®ã¿æŒ‡å®šã‚³ãƒŸãƒƒãƒˆã«ç§»å‹•
- ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ã‚¨ãƒªã‚¢ã¨ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯å¤‰æ›´ãªã—
- å–ã‚Šæ¶ˆã•ã‚ŒãŸã‚³ãƒŸãƒƒãƒˆã®å¤‰æ›´ã¯ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°æ¸ˆã¿çŠ¶æ…‹ã§æ®‹ã‚‹

#### --mixedï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰: HEAD + ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
```bash
git reset HEAD~1
git reset --mixed HEAD~1  # åŒã˜
```
- HEAD ã¨ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ã‚¨ãƒªã‚¢ã‚’æŒ‡å®šã‚³ãƒŸãƒƒãƒˆã«æˆ»ã™
- ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯å¤‰æ›´ãªã—
- å–ã‚Šæ¶ˆã•ã‚ŒãŸã‚³ãƒŸãƒƒãƒˆã®å¤‰æ›´ã¯æœªã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°çŠ¶æ…‹ã§æ®‹ã‚‹

#### --hard : ã™ã¹ã¦ãƒªã‚»ãƒƒãƒˆ
```bash
git reset --hard HEAD~1
```
- HEADã€ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ã‚¨ãƒªã‚¢ã€ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã™ã¹ã¦ã‚’æŒ‡å®šã‚³ãƒŸãƒƒãƒˆã«æˆ»ã™
- **å–ã‚Šæ¶ˆã•ã‚ŒãŸã‚³ãƒŸãƒƒãƒˆã®å¤‰æ›´ã¯å®Œå…¨ã«å‰Šé™¤ã•ã‚Œã‚‹**
- âš ï¸ **æœ€ã‚‚å±é™º** - ä½œæ¥­å†…å®¹ãŒå¤±ã‚ã‚Œã‚‹å¯èƒ½æ€§

### ğŸ”„ reset ã®å‹•ä½œãƒ‘ã‚¿ãƒ¼ãƒ³

```mermaid
gitGraph
    commit id: "A"
    commit id: "B"
    commit id: "C" type: HIGHLIGHT
    commit id: "D" type: REVERSE
    commit id: "E" type: REVERSE
```

```bash
# reset å‰
A---B---C---D---E (HEAD -> main)

# git reset --hard C å®Ÿè¡Œå¾Œ
A---B---C (HEAD -> main)
# D, E ã®ã‚³ãƒŸãƒƒãƒˆã¯å±¥æ­´ã‹ã‚‰å‰Šé™¤ã•ã‚Œã‚‹
```

### ğŸ“ reset ã®ä½¿ç”¨ä¾‹

```bash
# ç›´å‰ã®ã‚³ãƒŸãƒƒãƒˆã‚’å–ã‚Šæ¶ˆã—ï¼ˆå¤‰æ›´ã¯ä¿æŒï¼‰
git reset HEAD~1

# ç›´å‰ã®ã‚³ãƒŸãƒƒãƒˆã‚’å®Œå…¨ã«å–ã‚Šæ¶ˆã—
git reset --hard HEAD~1

# ç‰¹å®šã®ã‚³ãƒŸãƒƒãƒˆã¾ã§æˆ»ã‚‹
git reset --hard a1b2c3d

# ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ã‚¨ãƒªã‚¢ã‚’ã‚¯ãƒªã‚¢
git reset HEAD  # ã¾ãŸã¯ git reset

# ç‰¹å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ã‚’å–ã‚Šæ¶ˆã—
git reset HEAD filename.txt
```

### âš ï¸ reset ã®æ³¨æ„ç‚¹

1. **å±¥æ­´ã®æ”¹å¤‰**: ã‚³ãƒŸãƒƒãƒˆãŒå±¥æ­´ã‹ã‚‰å‰Šé™¤ã•ã‚Œã‚‹
2. **å…¬é–‹æ¸ˆã¿ãƒ–ãƒ©ãƒ³ãƒã§ã¯å±é™º**: ä»–ã®é–‹ç™ºè€…ã¨ã®åŒæœŸãŒå´©ã‚Œã‚‹
3. **--hard ã¯ç‰¹ã«å±é™º**: ä½œæ¥­å†…å®¹ãŒå¤±ã‚ã‚Œã‚‹
4. **å¾©æ—§ã¯å›°é›£**: reflog ã‚’ä½¿ã£ãŸå¾©æ—§ãŒå¿…è¦

---

## git revert - å–ã‚Šæ¶ˆã—ã‚³ãƒŸãƒƒãƒˆã®ä½œæˆ

### ğŸ“– æ¦‚è¦
æŒ‡å®šã—ãŸã‚³ãƒŸãƒƒãƒˆã§è¡Œã‚ã‚ŒãŸå¤‰æ›´ã‚’æ‰“ã¡æ¶ˆã™æ–°ã—ã„ã‚³ãƒŸãƒƒãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚å…ƒã®å±¥æ­´ã¯æ”¹å¤‰ã•ã‚Œã¾ã›ã‚“ã€‚

### ğŸ’¡ åŸºæœ¬çš„ãªä½¿ã„æ–¹

```bash
# ç‰¹å®šã®ã‚³ãƒŸãƒƒãƒˆã‚’å–ã‚Šæ¶ˆã—
git revert commit-hash

# è¤‡æ•°ã®ã‚³ãƒŸãƒƒãƒˆã‚’å–ã‚Šæ¶ˆã—
git revert commit1 commit2 commit3

# ç¯„å›²æŒ‡å®šã§å–ã‚Šæ¶ˆã—
git revert HEAD~3..HEAD

# ãƒãƒ¼ã‚¸ã‚³ãƒŸãƒƒãƒˆã®å–ã‚Šæ¶ˆã—ï¼ˆè¦ªã‚’æŒ‡å®šï¼‰
git revert merge-commit -m 1

# å–ã‚Šæ¶ˆã—ã®ã‚³ãƒŸãƒƒãƒˆã‚’ä½œã‚‰ãšã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ã®ã¿
git revert --no-commit commit-hash

# å–ã‚Šæ¶ˆã—ã®ä¸­æ­¢
git revert --abort

# å–ã‚Šæ¶ˆã—ã®ç¶™ç¶šï¼ˆã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆè§£æ±ºå¾Œï¼‰
git revert --continue
```

### ğŸ”„ revert ã®å‹•ä½œãƒ‘ã‚¿ãƒ¼ãƒ³

#### å˜ä¸€ã‚³ãƒŸãƒƒãƒˆã® revert
```mermaid
gitGraph
    commit id: "A"
    commit id: "B"
    commit id: "C" type: HIGHLIGHT
    commit id: "D"
    commit id: "E"
    commit id: "Revert C" type: REVERSE
```

```bash
# revert å‰
A---B---C---D---E (HEAD -> main)

# git revert C å®Ÿè¡Œå¾Œ
A---B---C---D---E---R (HEAD -> main)
# R ã¯ C ã®å¤‰æ›´ã‚’æ‰“ã¡æ¶ˆã™ã‚³ãƒŸãƒƒãƒˆ
# å…ƒã®å±¥æ­´ A,B,C,D,E ã¯ã™ã¹ã¦ä¿æŒã•ã‚Œã‚‹
```

#### è¤‡æ•°ã‚³ãƒŸãƒƒãƒˆã® revert
```mermaid
gitGraph
    commit id: "A"
    commit id: "B"
    commit id: "C" type: HIGHLIGHT
    commit id: "D" type: HIGHLIGHT
    commit id: "E" type: HIGHLIGHT
    commit id: "Revert E" type: REVERSE
    commit id: "Revert D" type: REVERSE
    commit id: "Revert C" type: REVERSE
```

### ğŸ“ revert ã®ä½¿ç”¨ä¾‹

```bash
# ç›´å‰ã®ã‚³ãƒŸãƒƒãƒˆã‚’å–ã‚Šæ¶ˆã—
git revert HEAD

# 2ã¤å‰ã®ã‚³ãƒŸãƒƒãƒˆã‚’å–ã‚Šæ¶ˆã—
git revert HEAD~2

# ç‰¹å®šã®ã‚³ãƒŸãƒƒãƒˆã‚’å–ã‚Šæ¶ˆã—
git revert a1b2c3d

# ãƒãƒ¼ã‚¸ã‚³ãƒŸãƒƒãƒˆã‚’å–ã‚Šæ¶ˆã—ï¼ˆ1ç•ªç›®ã®è¦ªã«æˆ»ã™ï¼‰
git revert merge-commit -m 1

# é€£ç¶šã—ãŸè¤‡æ•°ã‚³ãƒŸãƒƒãƒˆã‚’å–ã‚Šæ¶ˆã—
git revert HEAD~3..HEAD  # ç›´è¿‘3ã¤ã®ã‚³ãƒŸãƒƒãƒˆã‚’å–ã‚Šæ¶ˆã—
```

### âœ… revert ã®åˆ©ç‚¹

1. **å®‰å…¨æ€§**: å…ƒã®å±¥æ­´ã‚’æ”¹å¤‰ã—ãªã„
2. **å…¬é–‹ãƒ–ãƒ©ãƒ³ãƒã§å®‰å…¨**: ãƒãƒ¼ãƒ é–‹ç™ºã§å•é¡Œãªã—
3. **ç›£æŸ»è¨¼è·¡**: ä½•ã‚’å–ã‚Šæ¶ˆã—ãŸã‹ãŒå±¥æ­´ã«æ®‹ã‚‹
4. **ç°¡å˜ãªå¾©æ—§**: revert ã® revert ã§å…ƒã«æˆ»ã›ã‚‹

---

## å‹•ä½œã®é•ã„ã‚’ Mermaid ã§æ¯”è¼ƒ

### ğŸ”„ åŒã˜å•é¡Œã«å¯¾ã™ã‚‹ reset vs revert

#### åˆæœŸçŠ¶æ…‹ï¼šå•é¡Œã®ã‚ã‚‹ã‚³ãƒŸãƒƒãƒˆC
```mermaid
gitGraph
    commit id: "A"
    commit id: "B"
    commit id: "C" type: HIGHLIGHT
    commit id: "D"
    commit id: "E"
```

#### reset ã‚’é¸æŠã—ãŸå ´åˆ
```mermaid
gitGraph
    commit id: "A"
    commit id: "B"
```

**çµæœ**: ã‚³ãƒŸãƒƒãƒˆCä»¥é™ãŒã™ã¹ã¦å‰Šé™¤ã•ã‚Œã‚‹ï¼ˆD, Eã‚‚å¤±ã‚ã‚Œã‚‹ï¼‰

#### revert ã‚’é¸æŠã—ãŸå ´åˆ
```mermaid
gitGraph
    commit id: "A"
    commit id: "B"
    commit id: "C" type: HIGHLIGHT
    commit id: "D"
    commit id: "E"
    commit id: "Revert C" type: REVERSE
```

**çµæœ**: Cã®å¤‰æ›´ã®ã¿ãŒå–ã‚Šæ¶ˆã•ã‚Œã‚‹ï¼ˆD, Eã¯ä¿æŒï¼‰

### ğŸ“Š é¸æŠãƒ•ãƒ­ãƒ¼

```mermaid
flowchart TD
    A[ã‚³ãƒŸãƒƒãƒˆã‚’å–ã‚Šæ¶ˆã—ãŸã„] --> B{ãƒ–ãƒ©ãƒ³ãƒã¯å…¬é–‹æ¸ˆã¿ï¼Ÿ}
    
    B -->|Yes| C[git revert ã‚’ä½¿ç”¨]
    B -->|No| D{å–ã‚Šæ¶ˆã—å¯¾è±¡ã¯ï¼Ÿ}
    
    D -->|ç‰¹å®šã®ã‚³ãƒŸãƒƒãƒˆã®ã¿| E[git revert ã‚’æ¤œè¨]
    D -->|æœ€æ–°ã‹ã‚‰ã®é€£ç¶šã‚³ãƒŸãƒƒãƒˆ| F[git reset ã‚’æ¤œè¨]
    
    E --> G[å®‰å…¨ã«å–ã‚Šæ¶ˆã—]
    F --> H{ä½œæ¥­å†…å®¹ã¯ä¿æŒï¼Ÿ}
    
    H -->|ä¿æŒã—ãŸã„| I["git reset --soft<br/>ã¾ãŸã¯ --mixed"]
    H -->|ç ´æ£„ã—ã¦ã‚ˆã„| J["git reset --hard"]
    
    C --> K[å–ã‚Šæ¶ˆã—ã‚³ãƒŸãƒƒãƒˆä½œæˆ]
    G --> K
    I --> L[å±¥æ­´ã‚’å·»ãæˆ»ã—]
    J --> M[å±¥æ­´ã¨ä½œæ¥­å†…å®¹ã‚’ç ´æ£„]
```

---

## å®Ÿè·µä¾‹ã§ã®é•ã„ã®ç¢ºèª

### ğŸ§ª å®Ÿé¨“ç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# ç·´ç¿’ç”¨ãƒªãƒã‚¸ãƒˆãƒªã®ä½œæˆ
mkdir reset-revert-demo
cd reset-revert-demo
git init

# åˆæœŸå±¥æ­´ã®ä½œæˆ
echo "Version 1" > app.py && git add . && git commit -m "A: Initial version"
echo "Version 2" > app.py && git add . && git commit -m "B: Add feature X"
echo "Version 3 with bug" > app.py && git add . && git commit -m "C: Add feature Y (with bug)"
echo "Version 4" > app.py && git add . && git commit -m "D: Add feature Z"
echo "Version 5" > app.py && git add . && git commit -m "E: Update docs"
```

### âª reset ã®å®Ÿé¨“

```bash
# ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª
git log --oneline
# 12345ab (HEAD -> main) E: Update docs
# 67890cd D: Add feature Z
# abcde12 C: Add feature Y (with bug)
# 34567ef B: Add feature X
# 89012gh A: Initial version

# ãƒã‚°ã®ã‚ã‚‹ã‚³ãƒŸãƒƒãƒˆCã¾ã§æˆ»ã‚‹ï¼ˆD, Eã‚‚å‰Šé™¤ã•ã‚Œã‚‹ï¼‰
git reset --hard abcde12

# çµæœç¢ºèª
git log --oneline
# abcde12 (HEAD -> main) C: Add feature Y (with bug)
# 34567ef B: Add feature X
# 89012gh A: Initial version

cat app.py
# Version 3 with bug
```

**reset ã®çµæœ**:
- D ã¨ E ã®ã‚³ãƒŸãƒƒãƒˆãŒå±¥æ­´ã‹ã‚‰å®Œå…¨ã«å‰Šé™¤
- ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ã‚³ãƒŸãƒƒãƒˆCã®çŠ¶æ…‹
- D ã¨ E ã®å¤‰æ›´å†…å®¹ã¯å¤±ã‚ã‚ŒãŸ

### â†©ï¸ revert ã®å®Ÿé¨“

```bash
# ç’°å¢ƒã‚’ãƒªã‚»ãƒƒãƒˆ
git reflog  # å‰Šé™¤ã•ã‚ŒãŸã‚³ãƒŸãƒƒãƒˆã‚’ç¢ºèª
git reset --hard 12345ab  # E ã®çŠ¶æ…‹ã«æˆ»ã™

# ãƒã‚°ã®ã‚ã‚‹ã‚³ãƒŸãƒƒãƒˆCã®ã¿ã‚’å–ã‚Šæ¶ˆã—
git revert abcde12

# çµæœç¢ºèª
git log --oneline
# xyz789w (HEAD -> main) Revert "C: Add feature Y (with bug)"
# 12345ab E: Update docs
# 67890cd D: Add feature Z
# abcde12 C: Add feature Y (with bug)
# 34567ef B: Add feature X
# 89012gh A: Initial version

cat app.py
# Version 5 (Cã®å¤‰æ›´ãŒå–ã‚Šæ¶ˆã•ã‚ŒãŸãŒã€D, Eã®å¤‰æ›´ã¯ä¿æŒ)
```

**revert ã®çµæœ**:
- ã™ã¹ã¦ã®å±¥æ­´ãŒä¿æŒã•ã‚Œã‚‹
- æ–°ã—ã„ revert ã‚³ãƒŸãƒƒãƒˆãŒè¿½åŠ ã•ã‚Œã‚‹
- ã‚³ãƒŸãƒƒãƒˆ C ã®å¤‰æ›´ã®ã¿ãŒå–ã‚Šæ¶ˆã•ã‚Œã‚‹
- D ã¨ E ã®å¤‰æ›´ã¯ä¿æŒã•ã‚Œã‚‹

---

## ä½¿ã„åˆ†ã‘ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

### âœ… git reset ã‚’ä½¿ã†ã¹ãå ´é¢

```bash
# âœ… ãƒ­ãƒ¼ã‚«ãƒ«ã§ã®ç›´å‰ã‚³ãƒŸãƒƒãƒˆã®ä¿®æ­£
git reset --soft HEAD~1  # ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¿®æ­£ã—ãŸã„
git reset HEAD~1         # ã‚³ãƒŸãƒƒãƒˆã‚’åˆ†å‰²ã—ãŸã„

# âœ… ãƒ­ãƒ¼ã‚«ãƒ«ã§ã®ä½œæ¥­ã®ã‚„ã‚Šç›´ã—
git reset --hard HEAD~3  # æœ€è¿‘ã®3ã¤ã®ã‚³ãƒŸãƒƒãƒˆã‚’ã‚„ã‚Šç›´ã—

# âœ… ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ã‚¨ãƒªã‚¢ã®ã‚¯ãƒªã‚¢
git reset               # ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°æ¸ˆã¿ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æœªã‚¹ãƒ†ãƒ¼ã‚¸ã«æˆ»ã™
git reset filename.txt  # ç‰¹å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ã‚’å–ã‚Šæ¶ˆã—
```

**é©ç”¨å ´é¢:**
- ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã®ã¿
- æœªå…¬é–‹ã®ãƒ–ãƒ©ãƒ³ãƒ
- é€£ç¶šã—ãŸã‚³ãƒŸãƒƒãƒˆã‚’ã¾ã¨ã‚ã¦å–ã‚Šæ¶ˆã—ãŸã„
- ã‚³ãƒŸãƒƒãƒˆã®ä¿®æ­£ãƒ»åˆ†å‰²

### âœ… git revert ã‚’ä½¿ã†ã¹ãå ´é¢

```bash
# âœ… æœ¬ç•ªç’°å¢ƒã§ã®ç·Šæ€¥å¯¾å¿œ
git revert problematic-commit

# âœ… å…¬é–‹æ¸ˆã¿ãƒ–ãƒ©ãƒ³ãƒã§ã®å®‰å…¨ãªå–ã‚Šæ¶ˆã—
git revert feature-commit

# âœ… ç‰¹å®šã‚³ãƒŸãƒƒãƒˆã®ã¿ã®å–ã‚Šæ¶ˆã—
git revert HEAD~5  # 5ã¤å‰ã®ã‚³ãƒŸãƒƒãƒˆã®ã¿ã‚’å–ã‚Šæ¶ˆã—

# âœ… ãƒãƒ¼ã‚¸ã‚³ãƒŸãƒƒãƒˆã®å–ã‚Šæ¶ˆã—
git revert merge-commit -m 1
```

**é©ç”¨å ´é¢:**
- ãƒãƒ¼ãƒ é–‹ç™º
- å…¬é–‹æ¸ˆã¿ã®ãƒ–ãƒ©ãƒ³ãƒ
- æœ¬ç•ªç’°å¢ƒã§ã®ç·Šæ€¥å¯¾å¿œ
- ç‰¹å®šã®ã‚³ãƒŸãƒƒãƒˆã®ã¿ã‚’å–ã‚Šæ¶ˆã—ãŸã„
- å–ã‚Šæ¶ˆã—ã®å±¥æ­´ã‚’æ®‹ã—ãŸã„

### âš ï¸ å±é™ºãªãƒ‘ã‚¿ãƒ¼ãƒ³ã¨å¯¾ç­–

#### reset ã®å±é™ºãƒ‘ã‚¿ãƒ¼ãƒ³
```bash
# âŒ å±é™ºï¼šå…¬é–‹æ¸ˆã¿ãƒ–ãƒ©ãƒ³ãƒã§ã® reset
git reset --hard HEAD~3  # ä»–ã®é–‹ç™ºè€…ãŒæŒã¤å±¥æ­´ã¨çŸ›ç›¾

# âŒ å±é™ºï¼šé‡è¦ãªå¤‰æ›´ã‚’ --hard ã§å‰Šé™¤
git reset --hard HEAD~1  # ä½œæ¥­å†…å®¹ãŒå¤±ã‚ã‚Œã‚‹

# âœ… å®‰å…¨ãªä»£æ›¿æ¡ˆ
git revert HEAD HEAD~1 HEAD~2  # å€‹åˆ¥ã« revert
git reset --soft HEAD~3         # å¤‰æ›´å†…å®¹ã¯ä¿æŒ
```

#### revert ã®æ³¨æ„ãƒ‘ã‚¿ãƒ¼ãƒ³
```bash
# âš ï¸ æ³¨æ„ï¼šrevert å¾Œã®å†ãƒãƒ¼ã‚¸
git revert merge-commit -m 1
# å¾Œã§ã“ã®ãƒ–ãƒ©ãƒ³ãƒã‚’å†ãƒãƒ¼ã‚¸ã™ã‚‹å ´åˆã€ç‰¹åˆ¥ãªæ‰‹é †ãŒå¿…è¦

# âœ… æ­£ã—ã„å¯¾å‡¦
git revert revert-commit  # revert ã® revert
```

### ğŸ“‹ çŠ¶æ³åˆ¥ã®åˆ¤æ–­åŸºæº–

```mermaid
flowchart TD
    A[ã‚³ãƒŸãƒƒãƒˆã‚’å–ã‚Šæ¶ˆã—ãŸã„] --> B{ç·Šæ€¥åº¦ã¯ï¼Ÿ}
    
    B -->|ç·Šæ€¥| C{å…¬é–‹æ¸ˆã¿ï¼Ÿ}
    B -->|éç·Šæ€¥| D{ä½•ã‚’å–ã‚Šæ¶ˆã™ï¼Ÿ}
    
    C -->|Yes| E[git revert]
    C -->|No| F[git reset --hard]
    
    D -->|ç‰¹å®šã®ã‚³ãƒŸãƒƒãƒˆ| G[git revert]
    D -->|æœ€æ–°ã‹ã‚‰ã®é€£ç¶šã‚³ãƒŸãƒƒãƒˆ| H{å…¬é–‹æ¸ˆã¿ï¼Ÿ}
    
    H -->|Yes| I[git revert ã§å€‹åˆ¥ã«]
    H -->|No| J[git reset]
    
    E --> K[å®‰å…¨ã ãŒå±¥æ­´ã«æ®‹ã‚‹]
    F --> L[é«˜é€Ÿã ãŒå±é™º]
    G --> M[å®‰å…¨ã§æ­£ç¢º]
    I --> N[å®‰å…¨ã ãŒè¤‡æ•°ã‚³ãƒŸãƒƒãƒˆ]
    J --> O[é«˜é€Ÿã ãŒè¦æ³¨æ„]
```

## ğŸš¨ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### reset ã§å¤±ã£ãŸã‚³ãƒŸãƒƒãƒˆã®å¾©æ—§

```bash
# reflog ã§æ“ä½œå±¥æ­´ã‚’ç¢ºèª
git reflog

# å‡ºåŠ›ä¾‹:
# 1234567 (HEAD -> main) HEAD@{0}: reset: moving to HEAD~3
# abcdef8 HEAD@{1}: commit: Lost commit 3
# 9012345 HEAD@{2}: commit: Lost commit 2
# 6789abc HEAD@{3}: commit: Lost commit 1

# å¤±ã£ãŸã‚³ãƒŸãƒƒãƒˆã«æˆ»ã‚‹
git reset --hard abcdef8  # ã¾ãŸã¯ã‚³ãƒŸãƒƒãƒˆãƒãƒƒã‚·ãƒ¥
```

### revert ã§ã®ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆè§£æ±º

```bash
# ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆç™ºç”Ÿæ™‚
git revert problematic-commit
# Auto-merging file.txt
# CONFLICT (content): Merge conflict in file.txt

# 1. ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆã‚’è§£æ±º
# file.txt ã‚’ç·¨é›†

# 2. ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ã«è¿½åŠ 
git add file.txt

# 3. revert ã‚’å®Œäº†
git revert --continue

# ã¾ãŸã¯ä¸­æ­¢
git revert --abort
```

## ğŸ“š æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

reset ã¨ revert ã®é•ã„ã‚’ç†è§£ã—ãŸã‚‰ã€æ¬¡ã¯ [05. ãã®ä»–ã®é‡è¦ã‚³ãƒãƒ³ãƒ‰](05-other-important-commands.md) ã«é€²ã‚“ã§ã€cherry-pickã€stashã€reflog ãªã©ã®å¿œç”¨ã‚³ãƒãƒ³ãƒ‰ã«ã¤ã„ã¦å­¦ã³ã¾ã—ã‚‡ã†ã€‚